# 🧳 Co-Traveller：一站式智能旅行规划助手

本项目为北京大学《人工智能基础》课程大作业，由五人小组协作开发。Co-Traveller 致力于为用户提供一键式、全流程的智能旅行规划服务，集成了大模型行程自动生成、路线导航、行程票务与天气查询、语音助手、文档问答等多项功能，极大简化了出游前的准备流程。

---

## 📌 项目简介

Co-Traveller 采用模块化设计，前端基于 Gradio 实现多标签页交互式界面，后端集成大模型、地图、票务、天气、语音等多种 API。系统支持多模态交互，具备高可用性和良好工程规范，适用于希望高效、便捷安排行程的用户群体。



### ✨ 主要功能

- 🗺️ **旅行规划**：调用大模型接口，自动生成每日详细行程安排，支持流式输出，结果以表格形式展示。
- 🚗 **路线规划**：基于高德地图API，自动计算景点间最佳路线，并在地图上可视化展示。
- 🎫 **票务查询**：自动识别行程中的长距离移动，查询火车/飞机班次及票价。
- 🌦️ **天气查询**：调用和风天气API，展示未来三天天气及生活指数。
- 📚 **文档问答助手**：采用RAG技术，利用PDF攻略库实现城市百科式问答。
- 📝 **旅行攻略生成与预览**：一键生成 Markdown/PDF 旅行攻略文档，并可直接在界面中预览。

---



## 🏗️ 系统架构

- **前端**：基于 Gradio，支持多标签页（行程规划、路线规划、票务、天气、语音助手、文档问答等）。
- **后端**：Python，模块化开发，集成多种外部API（大模型、地图、票务、天气、语音等）。
- **知识库**：本地 PDF 攻略库，支持 RAG 检索增强问答。

---



## 🚀 快速开始

1. 克隆本仓库并安装依赖：
   ```
   git clone ...
   cd Co-Traveller
   pip install -r requirements.txt
   ```
2. 配置 `API.env`，`dataset/` 和 `src/models/bge-small-zh`，具体方法见后文相关章节。
3. 运行主程序：
   ```
   python src/travel.py
   ```
4. 终端将在主程序运行后给出程序运行端口，点击打开 Gradio 网页界面，体验各项功能。

---



## ⚙️ 依赖环境

- Python 3.8+
- 主要依赖包见 `requirements.txt`，安装请运行
  ```
  pip install -r requirements.txt
  ```
- 需安装 [ffmpeg](https://ffmpeg.org/)（用于音频处理），并配置到环境变量。
- **需手动安装 [wkhtmltopdf](https://wkhtmltopdf.org/downloads.html)（用于 Markdown/PDF 文档生成），并将其文件夹放置于 `scripts/` 或常见路径下。由于该文件较大，未随项目上传，请自行下载配置。**
- 或可选安装 Pandoc（用于 Markdown/PDF 文档生成）。

---



## 🔑 API 密钥配置

请在项目根目录下新建 `API.env` 文件，内容示例：

```
SILICON_API_KEY=你的大模型API Key
sub_SILICON_API_KEY=你的备用大模型API Key
AMAP_API_KEY=你的高德API密钥
BAIDU_API_KEY=你的百度语音API_KEY
BAIDU_SECRET_KEY=你的百度语音SECRET_KEY
BAIDU_APP_ID=你的百度语音APP_ID
X_QW_API_KEY=你的和风天气API Key
RAILWAY_APPCODE=你的火车票API AppCode
AIRPLANE_AUTHCODE=你的机票API AuthCode
```

> ⚠️ `API.env` 已被 `.gitignore` 忽略，请勿将密钥提交到公共仓库。

---



## 📂 知识库准备（PDF 旅行攻略）

请在项目根目录下新建 `dataset` 文件夹，并将你的 PDF 旅行攻略文件放入其中。  
每次运行检索功能时，系统会自动加载该文件夹下的所有 PDF 文档作为知识库。

> ⚠️ **RAG 检索所需的模型参数文件体积较大，未随仓库上传。请联系项目组或自行下载 [bge-small-zh](https://huggingface.co/BAAI/bge-small-zh) 模型，并将其置于 `src/models/bge-small-zh` 目录下，否则文档问答功能无法正常使用。**

> ⚠️ **dataset 文件夹中的 PDF 文件体积较大，未随仓库上传。请联系项目组获取，或自行准备参考旅行攻略 PDF 文件并置于 dataset 文件夹中。**

---



## 🗂️ 项目结构

```
Co-Traveller/
├── src/                # 主程序与各功能模块
├── dataset/            # RAG问答PDF库
├── temp/               # 临时文件与行程缓存
├── API.env             # API密钥配置（需自行创建）
├── requirements.txt    # Python依赖库
├── README.md           # 项目说明文档
└── ...                 # 其他文件
```

---




## 🖥️ 主要功能界面

- 🗺️ **查票与行程规划**：输入出发地、多个目的地和返程日期，获取查票链接和旅行建议。
- 🚗 **路线规划**：输入起点和终点，自动计算最佳驾车路线并可视化展示。
- 🎫 **票务查询**：查询火车票和机票信息，展示票价趋势。
- 🌦️ **地点天气查询**：输入地点，查看未来3天天气图标、描述、生活指数和地图。
- 📚 **文档问答助手**：输入关键词，检索PDF攻略库并由大模型生成专业答案。
- 📝 **旅行攻略生成与预览**：点击“生成旅行攻略”按钮自动生成 PDF 旅行攻略，并可通过“查看旅行攻略”按钮在网页端直接预览和下载。
- 📝 **行程历史管理**：保存、加载、删除历史旅行计划。

---



## 🙏 致谢

感谢北京大学《人工智能基础》课程组的指导与支持。

---
如需更多帮助，请参考各工具的官方文档或联系开发团队。
